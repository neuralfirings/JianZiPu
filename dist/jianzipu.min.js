const charMap={char:{x:0,y:0,w:1e3,h:1e3,components:[{key:"c",filename:"c_qiaqi_l",unicode:58e3,width:1e3},{key:"d",filename:"d_zhong_l",unicode:58001,width:1e3},{key:"f",filename:"f_index_l",unicode:58002,width:1e3},{key:"H",filename:"H_cuo_l",unicode:58003,width:1e3},{key:"h",filename:"h_tuo_l",unicode:58004,width:1e3},{key:"I",filename:"I_dacuo_l",unicode:58005,width:1e3},{key:"i",filename:"i_ti_l",unicode:58006,width:1e3},{key:"j",filename:"j_mo_l",unicode:58007,width:1e3},{key:"k",filename:"k_gou_l",unicode:58008,width:1e3},{key:"l",filename:"l_da_l",unicode:58009,width:1e3},{key:"n",filename:"n_bo_l",unicode:58010,width:1e3},{key:"O",filename:"O_fancuo_l",unicode:58011,width:1e3},{key:"o",filename:"o_zhai_l",unicode:58012,width:1e3},{key:"s",filename:"s_ming_l",unicode:58013,width:1e3},{key:"Y",filename:"Y_fancuo_l",unicode:58014,width:1e3},{key:"u",filename:"u_tiao_l",unicode:58015,width:1e3},{key:"v",filename:"v_da_l",unicode:58016,width:1e3},{key:"V",filename:"V_yan_l",unicode:58017,width:1e3},{key:"x",filename:"x_gui_l",unicode:58018,width:1e3},{key:"U",filename:"U_li_m",unicode:58019,width:1e3}]},chineseChar:{x:250,y:250,w:500,h:500,components:[{key:"分开",filename:"分开_char",unicode:58020,width:0},{key:"大息",filename:"大息_char",unicode:58021,width:0},{key:"少息",filename:"少息_char",unicode:58022,width:0},{key:"復",filename:"復_char",unicode:58023,width:0},{key:"泛止",filename:"泛止_char",unicode:58024,width:0},{key:"泛起",filename:"泛起_char",unicode:58025,width:0},{key:"退",filename:"退_char",unicode:58026,width:0},{key:"进",filename:"进_char",unicode:58027,width:0},{key:"长吟",filename:"长吟_char",unicode:58028,width:0},{key:"细吟",filename:"细吟_char",unicode:58029,width:0},{key:"带起",filename:"带起_char",unicode:58030,width:0},{key:"对起",filename:"对起_char",unicode:58031,width:0},{key:"爪起",filename:"爪起_char",unicode:58032,width:0},{key:"撇起",filename:"撇起_char",unicode:58033,width:0},{key:"起",filename:"起_char",unicode:58034,width:0}]},rhFull:{x:100,y:100,w:800,h:800,components:[{key:"n",filename:"n_bo_l",unicode:58035,width:0},{key:"h",filename:"h_tuo_l",unicode:58036,width:0},{key:"u",filename:"u_tiao_l",unicode:58037,width:0},{key:"k",filename:"k_gou_l",unicode:58038,width:0},{key:"i",filename:"i_ti_l",unicode:58039,width:0},{key:"l",filename:"l_da_l",unicode:58040,width:0},{key:"o",filename:"o_zhai_l",unicode:58041,width:0},{key:"ki",filename:"ki",unicode:58042,width:0},{key:"lo",filename:"lo",unicode:58043,width:0},{key:"c",filename:"c_qiaqi_l",unicode:58044,width:0},{key:"U",filename:"U_li_m",unicode:58045,width:0}]},strFull:{x:200,y:200,w:600,h:600,components:[{key:"1",filename:"1_yi_l",unicode:58046,width:0},{key:"2",filename:"2_er_l",unicode:58047,width:0},{key:"3",filename:"3_san_l",unicode:58048,width:0},{key:"4",filename:"4_si_l",unicode:58049,width:0},{key:"5",filename:"5_wu_l",unicode:58050,width:0},{key:"6",filename:"6_liu_l",unicode:58051,width:0},{key:"7",filename:"7_qi_l",unicode:58052,width:0}]},strFullTop:{x:355,y:200,w:290,h:290,components:[{key:"1",filename:"1_yi_l",unicode:58053,width:0},{key:"2",filename:"2_er_l",unicode:58054,width:0},{key:"3",filename:"3_san_l",unicode:58055,width:0},{key:"4",filename:"4_si_l",unicode:58056,width:0},{key:"5",filename:"5_wu_l",unicode:58057,width:0},{key:"6",filename:"6_liu_l",unicode:58058,width:0},{key:"7",filename:"7_qi_l",unicode:58059,width:0}]},strFullTop:{x:355,y:510,w:290,h:290,components:[{key:"1",filename:"1_yi_l",unicode:58060,width:0},{key:"2",filename:"2_er_l",unicode:58061,width:0},{key:"3",filename:"3_san_l",unicode:58062,width:0},{key:"4",filename:"4_si_l",unicode:58063,width:0},{key:"5",filename:"5_wu_l",unicode:58064,width:0},{key:"6",filename:"6_liu_l",unicode:58065,width:0},{key:"7",filename:"7_qi_l",unicode:58066,width:0}]},lhHalf:{x:100,y:100,w:374,h:305,components:[{key:"v",filename:"v_da_s",unicode:58067,width:0},{key:"f",filename:"f_index_s",unicode:58068,width:0},{key:"d",filename:"d_zhong_s",unicode:58069,width:0},{key:"s",filename:"s_ming_s",unicode:58070,width:0},{key:"x",filename:"x_gui_s",unicode:58071,width:0}]},huiHalf:{x:500,y:100,w:400,h:305,components:[{key:"1",filename:"1_yi_s",unicode:58072,width:0},{key:"2",filename:"2_er_s",unicode:58073,width:0},{key:"3",filename:"3_san_s",unicode:58074,width:0},{key:"4",filename:"4_si_s",unicode:58075,width:0},{key:"5",filename:"5_wu_s",unicode:58076,width:0},{key:"6",filename:"6_liu_s",unicode:58077,width:0},{key:"7",filename:"7_qi_s",unicode:58078,width:0},{key:"8",filename:"8_ba_s",unicode:58079,width:0},{key:"9",filename:"9_jiu_s",unicode:58080,width:0},{key:"10",filename:"10_shi_s",unicode:58081,width:0},{key:"11",filename:"11_s",unicode:58082,width:0},{key:"12",filename:"12_s",unicode:58083,width:0},{key:"13",filename:"13_s",unicode:58084,width:0}]},huiHalfTop:{x:500,y:100,w:400,h:150,components:[{key:"1",filename:"1_yi_s",unicode:58085,width:0},{key:"2",filename:"2_er_s",unicode:58086,width:0},{key:"3",filename:"3_san_s",unicode:58087,width:0},{key:"4",filename:"4_si_s",unicode:58088,width:0},{key:"5",filename:"5_wu_s",unicode:58089,width:0},{key:"6",filename:"6_liu_s",unicode:58090,width:0},{key:"7",filename:"7_qi_s",unicode:58091,width:0},{key:"8",filename:"8_ba_s",unicode:58092,width:0},{key:"9",filename:"9_jiu_s",unicode:58093,width:0},{key:"10",filename:"10_shi_s",unicode:58094,width:0},{key:"11",filename:"11_s",unicode:58095,width:0},{key:"12",filename:"12_s",unicode:58096,width:0},{key:"13",filename:"13_s",unicode:58097,width:0}]},huiHalfBottom:{x:500,y:255,w:400,h:150,components:[{key:"1",filename:"1_yi_s",unicode:58098,width:0},{key:"2",filename:"2_er_s",unicode:58099,width:0},{key:"3",filename:"3_san_s",unicode:58100,width:0},{key:"4",filename:"4_si_s",unicode:58101,width:0},{key:"5",filename:"5_wu_s",unicode:58102,width:0},{key:"6",filename:"6_liu_s",unicode:58103,width:0},{key:"7",filename:"7_qi_s",unicode:58104,width:0},{key:"8",filename:"8_ba_s",unicode:58105,width:0},{key:"9",filename:"9_jiu_s",unicode:58106,width:0}]},rhHalf:{x:100,y:431,w:800,h:469,components:[{key:"n",filename:"n_bo_m",unicode:58107,width:0},{key:"h",filename:"h_tuo_m",unicode:58108,width:0},{key:"u",filename:"u_tiao_m",unicode:58109,width:0},{key:"k",filename:"k_gou_m",unicode:58110,width:0},{key:"i",filename:"i_ti_m",unicode:58111,width:0},{key:"l",filename:"l_da_m",unicode:58112,width:0},{key:"o",filename:"o_zhai_m",unicode:58113,width:0},{key:"ki",filename:"ki",unicode:58114,width:0},{key:"lo",filename:"lo",unicode:58115,width:0},{key:"c",filename:"c_qiaqi_m",unicode:58116,width:0},{key:"U",filename:"U_li_m",unicode:58117,width:0}]},strHalf:{x:245,y:540,w:520,h:230,components:[{key:"1",filename:"1_yi_m",unicode:58118,width:0},{key:"2",filename:"2_er_m",unicode:58119,width:0},{key:"3",filename:"3_san_m",unicode:58120,width:0},{key:"4",filename:"4_si_m",unicode:58121,width:0},{key:"5",filename:"5_wu_m",unicode:58122,width:0},{key:"6",filename:"6_liu_m",unicode:58123,width:0},{key:"7",filename:"7_qi_m",unicode:58124,width:0}]},strHalfTop:{x:300,y:480,w:385,h:200,components:[{key:"1",filename:"1_yi_m",unicode:58125,width:0},{key:"2",filename:"2_er_m",unicode:58126,width:0},{key:"3",filename:"3_san_m",unicode:58127,width:0},{key:"4",filename:"4_si_m",unicode:58128,width:0},{key:"5",filename:"5_wu_m",unicode:58129,width:0},{key:"6",filename:"6_liu_m",unicode:58130,width:0},{key:"7",filename:"7_qi_m",unicode:58131,width:0}]},strHalfBottom:{x:300,y:700,w:385,h:200,components:[{key:"1",filename:"1_yi_m",unicode:58132,width:0},{key:"2",filename:"2_er_m",unicode:58133,width:0},{key:"3",filename:"3_san_m",unicode:58134,width:0},{key:"4",filename:"4_si_m",unicode:58135,width:0},{key:"5",filename:"5_wu_m",unicode:58136,width:0},{key:"6",filename:"6_liu_m",unicode:58137,width:0},{key:"7",filename:"7_qi_m",unicode:58138,width:0}]},thirdMidFull:{x:300,y:420,w:400,h:240,components:[{key:"j",filename:"j_mo_s",unicode:58139,width:0},{key:"V",filename:"V_yan_s",unicode:58140,width:0},{key:"0",filename:"0_san_m",unicode:58141,width:0},{key:"F",filename:"沸_s",unicode:58142,width:0},{key:"G",filename:"滚_s",unicode:58143,width:0},{key:"GF",filename:"滚沸_s",unicode:58144,width:0},{key:"D",filename:"到_s",unicode:58145,width:0}]},thirdMidLeft:{x:260,y:420,w:230,h:230,components:[{key:"v",filename:"v_da_s",unicode:58146,width:0},{key:"f",filename:"f_index_s",unicode:58147,width:0},{key:"d",filename:"d_zhong_s",unicode:58148,width:0},{key:"s",filename:"s_ming_s",unicode:58149,width:0},{key:"x",filename:"x_gui_s",unicode:58150,width:0}]},thirdMidRight:{x:500,y:420,w:230,h:230,components:[{key:"1",filename:"1_yi_s",unicode:58151,width:0},{key:"2",filename:"2_er_s",unicode:58152,width:0},{key:"3",filename:"3_san_s",unicode:58153,width:0},{key:"4",filename:"4_si_s",unicode:58154,width:0},{key:"5",filename:"5_wu_s",unicode:58155,width:0},{key:"6",filename:"6_liu_s",unicode:58156,width:0},{key:"7",filename:"7_qi_s",unicode:58157,width:0},{key:"8",filename:"8_ba_s",unicode:58158,width:0},{key:"9",filename:"9_jiu_s",unicode:58159,width:0},{key:"10",filename:"10_shi_s",unicode:58160,width:0},{key:"11",filename:"11_s",unicode:58161,width:0},{key:"12",filename:"12_s",unicode:58162,width:0},{key:"13",filename:"13_s",unicode:58163,width:0}]},rhThirdBottom:{x:100,y:660,w:800,h:305,components:[{key:"n",filename:"n_bo_m",unicode:58164,width:0},{key:"h",filename:"h_tuo_m",unicode:58165,width:0},{key:"u",filename:"u_tiao_m",unicode:58166,width:0},{key:"k",filename:"k_gou_m",unicode:58167,width:0},{key:"i",filename:"i_ti_m",unicode:58168,width:0},{key:"l",filename:"l_da_m",unicode:58169,width:0},{key:"o",filename:"o_zhai_m",unicode:58170,width:0},{key:"ki",filename:"ki",unicode:58171,width:0},{key:"lo",filename:"lo",unicode:58172,width:0}]},strThird:{x:230,y:690,w:540,h:250,components:[{key:"1",filename:"1_yi_l",unicode:58173,width:0},{key:"2",filename:"2_er_l",unicode:58174,width:0},{key:"3",filename:"3_san_l",unicode:58175,width:0},{key:"4",filename:"4_si_l",unicode:58176,width:0},{key:"5",filename:"5_wu_l",unicode:58177,width:0},{key:"6",filename:"6_liu_l",unicode:58178,width:0},{key:"7",filename:"7_qi_l",unicode:58179,width:0}]},halfUpper:{x:375,y:345,w:260,h:145,components:[{key:"/",filename:"fwdSlash_shang_s",unicode:58180,width:0},{key:">",filename:"ji_s",unicode:58181,width:0}]},halfLeft:{x:0,y:430,w:100,h:500,components:[{key:"\\",filename:"bckSlash_xia_m",unicode:58182,width:0}]},huiHalfFull:{x:100,y:100,w:800,h:305,components:[{key:"0",filename:"0_san_m",unicode:58183,width:0}]},cuo:{x:450,y:-175,w:825,h:1175,components:[{key:"H",filename:"H_cuo_m",unicode:58184,width:667},{key:"Y",filename:"Y_fancuo_m",unicode:58185,width:667},{key:"I",filename:"I_dacuo_m",unicode:58186,width:667},{key:"O",filename:"O_dafancuo_m",unicode:58187,width:667},{key:"B",filename:"bo",unicode:58188,width:667},{key:"L",filename:"la",unicode:58189,width:667},{key:"BL",filename:"bola",unicode:58190,width:667},{key:"TT",filename:"shuangtan",unicode:58191,width:667},{key:"TTT",filename:"santan",unicode:58192,width:667}]},thirdMidRightTop:{x:500,y:420,w:230,h:112,components:[{key:"1",filename:"1_yi_s",unicode:58193,width:0},{key:"2",filename:"2_er_s",unicode:58194,width:0},{key:"3",filename:"3_san_s",unicode:58195,width:0},{key:"4",filename:"4_si_s",unicode:58196,width:0},{key:"5",filename:"5_wu_s",unicode:58197,width:0},{key:"6",filename:"6_liu_s",unicode:58198,width:0},{key:"7",filename:"7_qi_s",unicode:58199,width:0},{key:"8",filename:"8_ba_s",unicode:58200,width:0},{key:"9",filename:"9_jiu_s",unicode:58201,width:0},{key:"10",filename:"10_shi_s",unicode:58202,width:0},{key:"11",filename:"11_s",unicode:58203,width:0},{key:"12",filename:"12_s",unicode:58204,width:0},{key:"13",filename:"13_s",unicode:58205,width:0}]},thirdMidRightBottom:{x:500,y:538,w:230,h:112,components:[{key:"1",filename:"1_yi_s",unicode:58206,width:0},{key:"2",filename:"2_er_s",unicode:58207,width:0},{key:"3",filename:"3_san_s",unicode:58208,width:0},{key:"4",filename:"4_si_s",unicode:58209,width:0},{key:"5",filename:"5_wu_s",unicode:58210,width:0},{key:"6",filename:"6_liu_s",unicode:58211,width:0},{key:"7",filename:"7_qi_s",unicode:58212,width:0},{key:"8",filename:"8_ba_s",unicode:58213,width:0},{key:"9",filename:"9_jiu_s",unicode:58214,width:0}]}};const charRules={for:/.*/,do:[{if:/[0-9]/,area:"strFull"},{if:/(n|ki|k|lo|l|h|u|i|o|c|U)/,area:"rhFull"},{if:/\(\d.*\)/,for:/.*/,do:[{if:/[0-9]/,area:"strHalf"},{if:/(n|ki|k|lo|h|u|i|o|c|U)/,area:"rhHalf"}]},{if:/(s|d|v|f|x)/,area:"lhHalf",for:/.*/,do:[{if:/[0-9]/,area:"strHalf"},{if:/(n|ki|k|lo|l|h|u|i|o|c|U)/,area:"rhHalf"}]},{if:/\(\d+\)/,for:/\(\d+\)/,do:[{if:/\(\d.*\)/,remove:["(",")"],area:"huiHalf"}]},{if:/\(.*\..\)/,for:/\(.*\..\)/,do:[{if:/\(\d.*\./,remove:["(","."],area:"huiHalfTop"},{if:/\.\d.*\)/,remove:[")","."],area:"huiHalfBottom"}]},{if:/[0-9],[0-9]/,for:/[0-9],[0-9]/,do:[{if:/\d.*\,/,remove:[","],area:"strHalfTop"},{if:/\,\d.*/,remove:[","],area:"strHalfBottom"}]},{if:/j|V|GF|G|F|D/,area:"thirdMidFull",for:/.*/,do:[{if:/[0-9]/,area:"strThird"},{if:/(n|ki|k|lo|l|h|u|i|o|c)/,area:"rhThirdBottom"}]},{if:/\(0\)/,for:/\(0\)/,do:[{if:/0/,area:"huiHalfFull"}]},{if:/\/|\>/,area:"halfUpper"},{if:/\\/,area:"halfLeft"},{if:/H|Y|I|O|TTT|TT|BL|B|L/,area:"cuo",for:/[^H|Y|I|O|TTT|TT|BL|B|L]*/i,do:[{if:/[0-9]/,area:"strHalf"},{if:/(s|d|v|f|x)|(\([0-9].*\))/,for:/.*/,do:[{if:/[0-9]/,area:"strThird"},{if:/s|d|v|f|x/,area:"thirdMidLeft"},{if:/\(\d+\)/,for:/\(\d+\)/,do:[{if:/\(\d.*\)/,remove:["(",")"],area:"thirdMidRight"}]},{if:/\(.*\..\)/,for:/\(.*\..\)/,do:[{if:/\(\d.*\./,remove:["(","."],area:"thirdMidRightTop"},{if:/\.\d.*\)/,remove:[")","."],area:"thirdMidRightBottom"}]},{if:/\(0\)/,for:/.*/,do:[{if:/0/,area:"thirdMidFull"}]}]}]},{if:/H|Y|I|O|TTT|TT|BL|B|L/,area:"cuo",for:/[H|Y|I|O|TTT|TT|BL|B|L](.*)/,do:[{if:/[0-9]/,area:"strHalf"},{if:/(s|d|v|f|x)|(\([0-9].*\))/,for:/.*/,do:[{if:/[0-9]/,area:"strThird"},{if:/s|d|v|f|x/,area:"thirdMidLeft"},{if:/\(\d+\)/,for:/\(\d+\)/,do:[{if:/\(\d.*\)/,remove:["(",")"],area:"thirdMidRight"}]},{if:/\(.*\..\)/,for:/\(.*\..\)/,do:[{if:/\(\d.*\./,remove:["(","."],area:"thirdMidRightTop"},{if:/\.\d.*\)/,remove:[")","."],area:"thirdMidRightBottom"}]},{if:/\(0\)/,for:/.*/,do:[{if:/0/,area:"thirdMidFull"}]}]}]},{if:/退/,area:"chineseChar"},{if:/长吟|長吟/,use:"长吟",area:"chineseChar"},{if:/细吟/,area:"chineseChar"},{if:/进|進/,use:"进",area:"chineseChar"},{if:/分开/,area:"chineseChar"},{if:/泛止/,area:"chineseChar"},{if:/大息/,area:"chineseChar"},{if:/少息/,area:"chineseChar"},{if:/复/,area:"chineseChar"},{if:/起/,area:"chineseChar"},{if:/泛起/,area:"chineseChar"},{if:/带起/,area:"chineseChar"},{if:/对起/,area:"chineseChar"},{if:/爪起/,area:"chineseChar"},{if:/撇起/,area:"chineseChar"}]};DEBUG=true;function getStructure(ogStr,structureMap){var strMap={};var str=ogStr.match(structureMap.for)[0];var startIdx=ogStr.match(structureMap.for).index;for(var i=0;i<structureMap.do.length;i++){if(str.match(structureMap.do[i].if)){var matchInfo=str.match(structureMap.do[i].if);if(matchInfo.index!=undefined){if(structureMap.do[i].area!=undefined){var matchChar=structureMap.do[i].use!=undefined?structureMap.do[i].use:matchInfo[0];if(structureMap.do[i].remove!=undefined){for(var j=0;j<structureMap.do[i].remove.length;j++){matchChar=matchChar.replaceAll(structureMap.do[i].remove[j],"")}}strMap[matchInfo.index+startIdx]={chars:matchChar,length:matchInfo[0].length,area:structureMap.do[i].area};for(var j=1;j<matchInfo[0].length;j++){delete strMap[matchInfo.index+startIdx+j]}}if(structureMap.do[i].for!=undefined){subStrMap=getStructure(str,structureMap.do[i]);for(var k in subStrMap){strMap[Number(k)+startIdx]=subStrMap[k];for(var j=1;j<subStrMap[k].length;j++){delete strMap[Number(k)+startIdx+j]}}DEBUG?console.log("subStrMap",subStrMap):0}}else if(false){var j=0;while(j<100&&(matchPartInfo=structureMap.do[i].if.exec(str))!=null){strMap[matchInfo.index]={chars:matchInfo[0],length:matchPartInfo[0].length,areas:structureMap.do[i].areas};strMapAreas=strMapAreas.concat(structureMap.do[i].areas);j++}}}}return strMap}function stringToCharacter(str){str=str.replaceAll("V","Vv");var strMap=getStructure(str,charRules);DEBUG?console.log("strMap",strMap):"";var character="";for(var k in strMap){for(var i=0;i<charMap[strMap[k].area].components.length;i++){if(charMap[strMap[k].area].components[i].key==strMap[k].chars){character+=String.fromCharCode(charMap[strMap[k].area].components[i].unicode)}}}return character}function paragraphToCharacters(para){var lines=para.split("\n");for(var j=0;j<lines.length;j++){var words=lines[j].split(" ");for(var i=0;i<words.length;i++){var cuo1,cuo2,translation;if(false&&words[i].split("H").length>1){cuo1=words[i].split("H")[0];cuo2=words[i].split("H")[1];translation=stringToCharacter(cuo1)+stringToCharacter("H")+stringToCharacter(cuo2)}else{translation=stringToCharacter(words[i])}words[i]=translation==""&&words[i]!=""?words[i]:translation+" "}lines[j]=words.join("")}return lines.join("\n")}document.addEventListener("DOMContentLoaded",function(event){var jzpInBrackets=document.getElementsByClassName("jzp");for(var i=0;i<jzpInBrackets.length;i++){let newDivHTML=jzpInBrackets[i].innerHTML;newDivHTML=newDivHTML.replaceAll("[[[",'<span class="jzp-font jzp-characters">').replaceAll("]]]","</span>");newDivHTML=newDivHTML.replaceAll("[[",'<span class="jzp-font">').replaceAll("]]","</span>");jzpInBrackets[i].innerHTML=newDivHTML;jzpInCharacters=jzpInBrackets[i].getElementsByClassName("jzp-characters");for(var j=0;j<jzpInCharacters.length;j++){jzpInCharacters[j].innerText=paragraphToCharacters(jzpInCharacters[j].innerText)}}});